<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Perhitungan Sisa Makanan (Comstock & Persentase) (by.Zaid Abdulloh)</title>
  <style>
    :root{
      --bg:#f6f9fb;
      --card:#ffffff;
      --accent:#1167b1;
      --muted:#666;
      --success:#1b8a3e;
      --danger:#d64545;
    }
    body{
      font-family: Inter, "Segoe UI", Roboto, Arial, Helvetica, sans-serif;
      background: linear-gradient(180deg, #e9f2fb 0%, var(--bg) 100%);
      padding: 28px;
      color:#111;
    }
    .container{
      max-width:980px;
      margin:0 auto;
    }
    header{
      display:flex;
      gap:16px;
      align-items:center;
      margin-bottom:18px;
    }
    h1{ margin:0; font-size:20px; color:var(--accent); }
    p.lead{ margin:0; color:var(--muted); font-size:13px; }

    .card{
      background:var(--card);
      border-radius:10px;
      box-shadow:0 6px 20px rgba(20,40,60,0.06);
      padding:18px;
      margin-bottom:14px;
    }

    table{
      width:100%;
      border-collapse:collapse;
      margin-top:8px;
    }
    th, td{
      padding:10px 8px;
      text-align:left;
      border-bottom:1px solid #eef3f7;
      font-size:14px;
    }
    th{ background:#fbfdff; color:#234; font-weight:600; }
    input[type="number"]{
      width:100%;
      box-sizing:border-box;
      padding:6px 8px;
      border:1px solid #d5e6f6;
      border-radius:6px;
      font-size:14px;
      text-align:right;
      background: #fbfeff;
    }
    .muted{ color:var(--muted); font-size:13px; }
    .results{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
      margin-top:10px;
    }
    .result-card{
      padding:12px;
      border-radius:8px;
      background:linear-gradient(180deg,#fff,#fbfdff);
      border:1px solid #eef6ff;
    }
    .r-value{ font-size:20px; font-weight:700; color:#0b3a66; }
    .r-sub{ color:var(--muted); font-size:13px; margin-top:6px; }

    .interpret{ margin-top:12px; font-size:14px; }
    .btn-row{ display:flex; gap:8px; margin-top:12px; }
    button{
      background:var(--accent);
      border:none;
      color:#fff;
      padding:8px 12px;
      border-radius:8px;
      cursor:pointer;
      font-weight:600;
    }
    button.alt{ background:#6ba6d8; }
    .small{ font-size:13px; padding:6px 10px; border-radius:6px; }
    footer{ margin-top:14px; color:var(--muted); font-size:13px; text-align:center; }
    .note{ font-size:13px; color:var(--muted); margin-top:6px; }
    @media (max-width:720px){
      .results{ grid-template-columns:1fr; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Perhitungan Sisa Makanan (By. Zaid Abdulloh)</h1>
        <p class="lead">Metode Comstock (skor 0–5) & Metode Persentase Langsung — isi jumlah piring lalu lihat hasil</p>
      </div>
    </header>

    <section class="card" aria-labelledby="input-title">
      <h3 id="input-title" style="margin:0 0 8px 0;font-size:15px;color:#123e66">Input Observasi</h3>
      <div class="muted">Masukkan jumlah piring (observasi Anda) untuk setiap kategori sisa</div>

      <table role="table" aria-label="Tabel input">
        <thead>
          <tr>
            <th style="width:20%;">Kategori Sisa (%)</th>
            <th style="width:20%;">Skor (Comstock)</th>
            <th style="width:40%;">Jumlah Piring (input)</th>
            <th style="width:20%;">Contoh</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>0 (Tidak bersisa / Habis)</td>
            <td style="font-weight:700; color:#0b6b24">5</td>
            <td><input id="c0" type="number" min="0" step="1" value="48" /></td>
            <td class="muted">contoh: 48</td>
          </tr>
          <tr>
            <td>25 (Sisa 1/4)</td>
            <td style="font-weight:700; color:#0b6b24">4</td>
            <td><input id="c25" type="number" min="0" step="1" value="18" /></td>
            <td class="muted">contoh: 18</td>
          </tr>
          <tr>
            <td>50 (Sisa 1/2)</td>
            <td style="font-weight:700; color:#0b6b24">3</td>
            <td><input id="c50" type="number" min="0" step="1" value="6" /></td>
            <td class="muted">contoh: 6</td>
          </tr>
          <tr>
            <td>75 (Sisa 3/4)</td>
            <td style="font-weight:700; color:#0b6b24">2</td>
            <td><input id="c75" type="number" min="0" step="1" value="4" /></td>
            <td class="muted">contoh: 4</td>
          </tr>
          <tr>
            <td>95 (Dicicip sedikit ≈ 95% sisa)</td>
            <td style="font-weight:700; color:#0b6b24">1</td>
            <td><input id="c95" type="number" min="0" step="1" value="4" /></td>
            <td class="muted">contoh: 4</td>
          </tr>
          <tr>
            <td>100 (Tidak dimakan sama sekali)</td>
            <td style="font-weight:700; color:#0b6b24">0</td>
            <td><input id="c100" type="number" min="0" step="1" value="9" /></td>
            <td class="muted">contoh: 9</td>
          </tr>
        </tbody>
      </table>

      <div class="btn-row">
        <button id="btnCalc">Hitung Sekarang</button>
        <button class="alt" id="btnAuto">Update Otomatis (On/Off)</button>
        <button class="alt small" id="btnReset">Reset contoh</button>
      </div>

      <div class="note">
        Catatan: kategori & skor mengikuti formulir Comstock (skor 5 = habis; skor 0 = tidak dimakan). Anda bisa ubah nilai jumlah lalu klik <strong>Hitung Sekarang</strong> atau aktifkan <em>Update Otomatis</em>.
      </div>
    </section>

    <section class="card">
      <h3 style="margin:0 0 8px 0;font-size:15px;color:#123e66">Hasil</h3>

      <div class="results" role="region" aria-live="polite">
        <div class="result-card">
          <div class="muted">Total piring (N)</div>
          <div class="r-value" id="totalPlates">—</div>
          <div class="r-sub">Jumlah seluruh piring yang diamati</div>
        </div>

        <div class="result-card">
          <div class="muted">Total skor aktual</div>
          <div class="r-value" id="totalScore">—</div>
          <div class="r-sub">Σ (jumlah × skor)</div>
        </div>

        <div class="result-card">
          <div class="muted">% Konsumsi (Metode Skor Comstock)</div>
          <div class="r-value" id="consumptionPct">—</div>
          <div class="r-sub">% konsumsi = total skor / (N × 5) × 100</div>
        </div>

        <div class="result-card">
          <div class="muted">% Sisa (Metode Skor Comstock)</div>
          <div class="r-value" id="comstockWaste">—</div>
          <div class="r-sub">% sisa = 100 − % konsumsi</div>
        </div>

        <div class="result-card">
          <div class="muted">% Sisa (Metode Persentase Langsung)</div>
          <div class="r-value" id="directWaste">—</div>
          <div class="r-sub">Σ (jumlah × %sisa) / N</div>
        </div>

        <div class="result-card">
          <div class="muted">Interpretasi (ambang ≤ 20%)</div>
          <div class="r-value" id="interpret">—</div>
          <div class="r-sub">Nilai ≤20% = diterima / memuaskan</div>
        </div>
      </div>

      <div class="interpret">
        <strong>Penjelasan singkat:</strong>
        <ul style="margin:6px 0 0 18px;color:var(--muted)">
          <li>Metode Comstock menggunakan skor ordinal 0–5 (mudah dipakai di audit individu).</li>
          <li>Metode Persentase Langsung rata-rata memakai nilai persentase sisa (lebih presisi bila kategori % sebenarnya diketahui).</li>
          <li>Perbedaan angka di kedua metode normal — keduanya valid, pilih sesuai tujuan (audit cepat vs analisis akurat).</li>
        </ul>
      </div>
    </section>

    <footer>
      zaidabdulloh91@gmail.com
    </footer>
  </div>

  <script>
    (function(){
      // elemen input
      const el = {
        c0: document.getElementById('c0'),
        c25: document.getElementById('c25'),
        c50: document.getElementById('c50'),
        c75: document.getElementById('c75'),
        c95: document.getElementById('c95'),
        c100: document.getElementById('c100'),
        btnCalc: document.getElementById('btnCalc'),
        btnAuto: document.getElementById('btnAuto'),
        btnReset: document.getElementById('btnReset'),
        totalPlates: document.getElementById('totalPlates'),
        totalScore: document.getElementById('totalScore'),
        consumptionPct: document.getElementById('consumptionPct'),
        comstockWaste: document.getElementById('comstockWaste'),
        directWaste: document.getElementById('directWaste'),
        interpret: document.getElementById('interpret'),
      };

      // constants
      const categories = [0,25,50,75,95,100];
      // mapping skor: index aligned with categories
      const scores = [5,4,3,2,1,0];

      let auto = false;

      function parseIntSafe(v){
        const n = parseInt(v,10);
        return Number.isFinite(n) ? n : 0;
      }

      function computeAndShow(){
        // read counts
        const counts = [
          parseIntSafe(el.c0.value),
          parseIntSafe(el.c25.value),
          parseIntSafe(el.c50.value),
          parseIntSafe(el.c75.value),
          parseIntSafe(el.c95.value),
          parseIntSafe(el.c100.value)
        ];

        const totalPlates = counts.reduce((a,b)=>a+b,0);
        el.totalPlates.textContent = totalPlates.toLocaleString();

        // compute total skor aktual
        let totalScore = 0;
        for(let i=0;i<counts.length;i++){
          totalScore += counts[i] * scores[i];
        }
        el.totalScore.textContent = totalScore.toLocaleString();

        // consumption percent (Comstock)
        let consumptionPct = totalPlates === 0 ? 0 : (totalScore / (totalPlates * 5) * 100);
        el.consumptionPct.textContent = totalPlates === 0 ? "—" : consumptionPct.toFixed(2) + " %";

        // comstock waste
        let comstockWaste = totalPlates === 0 ? 0 : (100 - consumptionPct);
        el.comstockWaste.textContent = totalPlates === 0 ? "—" : comstockWaste.toFixed(2) + " %";

        // direct percent waste = sum(count * percent) / N
        let numeratorDirect = 0;
        for(let i=0;i<counts.length;i++){
          numeratorDirect += counts[i] * categories[i];
        }
        let directWaste = totalPlates === 0 ? 0 : (numeratorDirect / totalPlates);
        el.directWaste.textContent = totalPlates === 0 ? "—" : directWaste.toFixed(2) + " %";

        // interpretation
        const threshold = 20;
        let interpText = '';
        if(totalPlates === 0){
          interpText = 'Masukkan jumlah piring untuk melihat interpretasi';
        } else {
          // pick the stricter one (higher sisa) to interpret conservatively? we'll show both.
          const higher = Math.max(comstockWaste, directWaste);
          if(higher <= threshold){
            interpText = 'Baik — tingkat sisa ≤ ' + threshold + '% (memuaskan)';
            el.interpret.style.color = 'var(--success)';
          } else {
            interpText = 'Tinggi — tingkat sisa > ' + threshold + '% (perlu perhatian)';
            el.interpret.style.color = 'var(--danger)';
          }
        }
        el.interpret.textContent = interpText;
      }

      // attach events
      el.btnCalc.addEventListener('click', computeAndShow);

      // auto toggle
      el.btnAuto.addEventListener('click', function(){
        auto = !auto;
        el.btnAuto.textContent = auto ? 'Update Otomatis: ON' : 'Update Otomatis (On/Off)';
        if(auto){
          [el.c0,el.c25,el.c50,el.c75,el.c95,el.c100].forEach(inp=>{
            inp.addEventListener('input', computeAndShow);
          });
          computeAndShow();
        } else {
          [el.c0,el.c25,el.c50,el.c75,el.c95,el.c100].forEach(inp=>{
            inp.removeEventListener('input', computeAndShow);
          });
        }
      });

      el.btnReset.addEventListener('click', function(){
        el.c0.value = 48;
        el.c25.value = 18;
        el.c50.value = 6;
        el.c75.value = 4;
        el.c95.value = 4;
        el.c100.value = 9;
        computeAndShow();
      });

      // initial compute once
      computeAndShow();

    })();
  </script>
</body>
</html>
